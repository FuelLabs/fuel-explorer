import{$ as L,_ as E}from"./index-PzP5oypK.js";import{r as t}from"./index-4g5l5LRQ.js";import{$ as y}from"./index-pbeB-vsG.js";import{$ as h,a as z}from"./index-OvZZPJzn.js";import{b as O}from"./index-uUL8xeMH.js";import{R as A}from"./index-jmm5gWkb.js";function K(n,e=globalThis==null?void 0:globalThis.document){const s=O(n);t.useEffect(()=>{const r=o=>{o.key==="Escape"&&s(o)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[s,e])}const m="dismissableLayer.update",N="dismissableLayer.pointerDownOutside",H="dismissableLayer.focusOutside";let x;const R=t.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),M=t.forwardRef((n,e)=>{var s;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:b,onInteractOutside:l,onDismiss:u,...v}=n,c=t.useContext(R),[d,I]=t.useState(null),f=(s=d==null?void 0:d.ownerDocument)!==null&&s!==void 0?s:globalThis==null?void 0:globalThis.document,[,W]=t.useState({}),_=L(e,i=>I(i)),g=Array.from(c.layers),[B]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),S=g.indexOf(B),D=d?g.indexOf(d):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,P=D>=S,U=j(i=>{const $=i.target,T=[...c.branches].some(p=>p.contains($));!P||T||(a==null||a(i),l==null||l(i),i.defaultPrevented||u==null||u())},f),w=q(i=>{const $=i.target;[...c.branches].some(p=>p.contains($))||(b==null||b(i),l==null||l(i),i.defaultPrevented||u==null||u())},f);return K(i=>{D===c.layers.size-1&&(o==null||o(i),!i.defaultPrevented&&u&&(i.preventDefault(),u()))},f),t.useEffect(()=>{if(d)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(x=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),C(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=x)}},[d,f,r,c]),t.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),C())},[d,c]),t.useEffect(()=>{const i=()=>W({});return document.addEventListener(m,i),()=>document.removeEventListener(m,i)},[]),t.createElement(h.div,E({},v,{ref:_,style:{pointerEvents:k?P?"auto":"none":void 0,...n.style},onFocusCapture:y(n.onFocusCapture,w.onFocusCapture),onBlurCapture:y(n.onBlurCapture,w.onBlurCapture),onPointerDownCapture:y(n.onPointerDownCapture,U.onPointerDownCapture)}))}),X=t.forwardRef((n,e)=>{const s=t.useContext(R),r=t.useRef(null),o=L(e,r);return t.useEffect(()=>{const a=r.current;if(a)return s.branches.add(a),()=>{s.branches.delete(a)}},[s.branches]),t.createElement(h.div,E({},n,{ref:o}))});function j(n,e=globalThis==null?void 0:globalThis.document){const s=O(n),r=t.useRef(!1),o=t.useRef(()=>{});return t.useEffect(()=>{const a=l=>{if(l.target&&!r.current){let v=function(){F(N,s,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=v,e.addEventListener("click",o.current,{once:!0})):v()}else e.removeEventListener("click",o.current);r.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",a),e.removeEventListener("click",o.current)}},[e,s]),{onPointerDownCapture:()=>r.current=!0}}function q(n,e=globalThis==null?void 0:globalThis.document){const s=O(n),r=t.useRef(!1);return t.useEffect(()=>{const o=a=>{a.target&&!r.current&&F(H,s,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,s]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function C(){const n=new CustomEvent(m);document.dispatchEvent(n)}function F(n,e,s,{discrete:r}){const o=s.originalEvent.target,a=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:s});e&&o.addEventListener(n,e,{once:!0}),r?z(o,a):o.dispatchEvent(a)}const te=M,ne=X,se=t.forwardRef((n,e)=>{var s;const{container:r=globalThis==null||(s=globalThis.document)===null||s===void 0?void 0:s.body,...o}=n;return r?A.createPortal(t.createElement(h.div,E({},o,{ref:e})),r):null}),G=t.forwardRef((n,e)=>t.createElement(h.span,E({},n,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}))),oe=G;export{se as $,M as a,ne as b,G as c,te as d,oe as e};
